<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    
    <title>Document</title>
</head>
<body>
  <div class="container">
  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTKtliZWAX-7fioOno2IlznBVnq32KJIjpRxVTNoVAQfS3DDXkBPQ" alt="" data-src="https://img3.doubanio.com/view/photo/l/public/p1642875970.webp">
  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTKtliZWAX-7fioOno2IlznBVnq32KJIjpRxVTNoVAQfS3DDXkBPQ" alt="" data-src="https://img3.doubanio.com/view/photo/l/public/p1642851065.webp">
  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTKtliZWAX-7fioOno2IlznBVnq32KJIjpRxVTNoVAQfS3DDXkBPQ" alt="" data-src="https://img3.doubanio.com/view/photo/l/public/p1642597713.webp">
  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTKtliZWAX-7fioOno2IlznBVnq32KJIjpRxVTNoVAQfS3DDXkBPQ" alt="" data-src="https://img3.doubanio.com/view/photo/l/public/p1641229980.webp">
  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTKtliZWAX-7fioOno2IlznBVnq32KJIjpRxVTNoVAQfS3DDXkBPQ" alt="" data-src="https://img1.doubanio.com/view/photo/l/public/p1641229937.webp">
  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTKtliZWAX-7fioOno2IlznBVnq32KJIjpRxVTNoVAQfS3DDXkBPQ" alt="" data-src="https://img3.doubanio.com/view/photo/l/public/p1641168894.webp">
  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTKtliZWAX-7fioOno2IlznBVnq32KJIjpRxVTNoVAQfS3DDXkBPQ" alt="" data-src="https://img3.doubanio.com/view/photo/l/public/p1640045500.webp">
  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTKtliZWAX-7fioOno2IlznBVnq32KJIjpRxVTNoVAQfS3DDXkBPQ" alt="" data-src="https://img3.doubanio.com/view/photo/l/public/p1640005141.webp">
  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTKtliZWAX-7fioOno2IlznBVnq32KJIjpRxVTNoVAQfS3DDXkBPQ" alt="" data-src="https://img3.doubanio.com/view/photo/l/public/p1639892731.webp">
  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTKtliZWAX-7fioOno2IlznBVnq32KJIjpRxVTNoVAQfS3DDXkBPQ" alt="" data-src="https://img3.doubanio.com/view/photo/l/public/p1639867571.webp">
  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTKtliZWAX-7fioOno2IlznBVnq32KJIjpRxVTNoVAQfS3DDXkBPQ" alt="" data-src="https://img3.doubanio.com/view/photo/l/public/p1639717464.webp">
  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTKtliZWAX-7fioOno2IlznBVnq32KJIjpRxVTNoVAQfS3DDXkBPQ" alt="" data-src="https://img3.doubanio.com/view/photo/l/public/p1639682653.webp">
  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTKtliZWAX-7fioOno2IlznBVnq32KJIjpRxVTNoVAQfS3DDXkBPQ" alt="" data-src="https://img3.doubanio.com/view/photo/l/public/p1639682601.webp">
  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTKtliZWAX-7fioOno2IlznBVnq32KJIjpRxVTNoVAQfS3DDXkBPQ" alt="" data-src="https://img3.doubanio.com/view/photo/l/public/p1639368646.webp">
  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTKtliZWAX-7fioOno2IlznBVnq32KJIjpRxVTNoVAQfS3DDXkBPQ" alt="" data-src="https://img3.doubanio.com/view/photo/l/public/p1639368375.webp">
  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTKtliZWAX-7fioOno2IlznBVnq32KJIjpRxVTNoVAQfS3DDXkBPQ" alt="" data-src="https://img3.doubanio.com/view/photo/l/public/p1639152480.webp">
  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTKtliZWAX-7fioOno2IlznBVnq32KJIjpRxVTNoVAQfS3DDXkBPQ" alt="" data-src="https://img1.doubanio.com/view/photo/l/public/p1638660838.webp">
  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTKtliZWAX-7fioOno2IlznBVnq32KJIjpRxVTNoVAQfS3DDXkBPQ" alt="" data-src="https://img3.doubanio.com/view/photo/l/public/p1637299146.webp">
  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTKtliZWAX-7fioOno2IlznBVnq32KJIjpRxVTNoVAQfS3DDXkBPQ" alt="" data-src="https://img3.doubanio.com/view/photo/l/public/p1636700286.webp">
  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTKtliZWAX-7fioOno2IlznBVnq32KJIjpRxVTNoVAQfS3DDXkBPQ" alt="" data-src="https://img3.doubanio.com/view/photo/l/public/p1636234783.webp">
  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTKtliZWAX-7fioOno2IlznBVnq32KJIjpRxVTNoVAQfS3DDXkBPQ" alt="" data-src="https://img3.doubanio.com/view/photo/l/public/p1636099756.webp">
  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTKtliZWAX-7fioOno2IlznBVnq32KJIjpRxVTNoVAQfS3DDXkBPQ" alt="" data-src="https://img1.doubanio.com/view/photo/l/public/p1635889458.webp">
  <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTKtliZWAX-7fioOno2IlznBVnq32KJIjpRxVTNoVAQfS3DDXkBPQ" alt="" data-src="https://img3.doubanio.com/view/photo/l/public/p1635889444.webp">
  


</div>


</body>
<style>
  img{
     position: absolute; 
    width: 250px;
   
  }
  .container{
    scroll-behavior: smooth;
  }
</style>
<script src="https://cdn.bootcss.com/jquery/2.2.1/jquery.js"></script>
<script>
 
  start()
  
  $('window').on('scroll',function(){
    start()
  })
  function start(){
    $('img').not('[data-isloaded]').each(function(){   
      var $node=$(this)
  
      if( isShow($node)){
        loadImg($node)
      }
    })
  }   
  function isShow($node){
    return $node.offset().top<=$(window).height()+$(window).scrollTop()
  }
  function loadImg($img){
    
    $img.attr('src',$img.attr('data-src'))
    $img.attr('data-isloaded',1)
  }
 

   var  waterfall={
    
    init:function(){
      this.colHeightArray=[]
      this.imgwidth=$('img').outerWidth(true)
      this.colCount=Math.floor($('.container').width()/this.imgwidth)
      for(let i=0;i<this.colCount;i++){
        this.colHeightArray[i]=0
      } 
      this.bind()
    },
    bind:function(){
      let _this=this
      $('img').on('load',function(){
        _this.layout($(this))

      })
    
      $(window).on('resize',function(){
        _this.init()
        $('img').each(function(){
          _this.layout($(this))
        })
      })
        
    },
    layout:function($node){
      let minvalue=this.colHeightArray[0]
      let minIndex=0
      for(let i=0;i<this.colCount;i++){
        if(this.colHeightArray[i]<minvalue){
          minvalue=this.colHeightArray[i]
          minIndex=i
          console.log(minvalue)
        }
      }
      $($node).css({
        left:minIndex*this.imgwidth,
        top:minvalue
      })
      this.colHeightArray[minIndex]+=$($node).outerHeight()
    }
  
  }
  waterfall.init()
</script> 
</html>